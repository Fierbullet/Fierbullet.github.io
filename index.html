function doPost(e) {
  try {
    const SPREADSHEET_ID = 'ВАШ_SPREADSHEET_ID_HERE'; // <- вставь сюда ID таблицы
    const SHEET_NAME = 'Sheet1'; // или имя листа, куда нужно добавлять

    // Собираем данные: сначала пытаемся распарсить JSON тело
    let data = {};
    if (e.postData && e.postData.contents) {
      try {
        data = JSON.parse(e.postData.contents);
      } catch (err) {
        // не JSON — игнорируем
      }
    }
    // Дальше дополняем параметрами (form-encoded)
    if (e.parameter) {
      for (let k in e.parameter) {
        if (e.parameter.hasOwnProperty(k)) data[k] = e.parameter[k];
      }
    }

    // Получаем таблицу и лист
    const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    const sheet = ss.getSheetByName(SHEET_NAME) || ss.getSheets()[0];

    // Формируем строку (вставляем orderNumber первым)
    const row = [
      new Date(),
      data.orderNumber || '',
      data.name || '',
      data.phone || '',
      data.email || '',
      data.address || '',
      data.date || '',
      data.items || '',
      data.total || '',
      data.message || ''
    ];

    sheet.appendRow(row);

    // Возвращаем JSON успеха
    return ContentService
      .createTextOutput(JSON.stringify({ status: 'ok', message: 'row appended' }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    // лог всех ошибок в Stackdriver/Execution log
    console.error(err);
    return ContentService
      .createTextOutput(JSON.stringify({ status: 'error', error: String(err) }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
